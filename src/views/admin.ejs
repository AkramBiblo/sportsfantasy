<body style="
    background: url(/img/bg.jpg);
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
  ">

  <div class="container text-center mt-5">
    <%- include('./partials/successMsg.ejs') %>
    <div class="container text-center errorMessageDiv">
        <div class="alert alert-danger">
            <h6 id="errorMessage"></h6>
          </div>
    </div>
    <div class="getTable" style="color: rgb(3, 3, 3);">
      Book your schedule <input type="date">
    </div>
  </div>
  
  <div class="container-fluid">
  <!-- <h2 style="color: white;">Book your schedule</h2> -->
  <h5 style="color: rgb(254, 252, 252);"><span id="Date"></span><span id="weekDay"></span></h5>
  <h5 id="month"></h5>
  <div class="table-responsive">
    <table class="table table-bordered">
      <thead>
        <tr>
          <td>5:00am-6:00am</td>
          <td>6:00am-7:00am</td>
          <td>7:00am-8:00am</td>
          <td>8:00am-9:00am</td>
          <td>9:00am-10:00am</td>
          <td>10:00am-11:00am</td>
          <td>11:00am-12:00pm</td>
          <td>12:00pm-1:00pm</td>
          <td>1:00pm-2:00pm</td>
          <td>2:00pm-3:00pm</td>
          <td>3:00pm-4:00pm</td>
          <td>4:00pm-5:00pm</td>
          <td>5:00pm-6:00pm</td>
          <td>6:00pm-7:00pm</td>
          <td>7:00pm-8:00pm</td>
          <td>8:00pm-9:00pm</td>
          <td>9:00pm-10:00pm</td>
          <td>10:00pm-11:00pm</td>
          <td>11:00pm-12:00am</td>
          <td>12:00am-1:00am</td>
          <td>1:00am-2:00am</td>
          <td>2:00am-3:00am</td>
          <td>3:00am-4:00am</td>
          <td>4:00am-5:00am</td>
        </tr>
      </thead>
      <tbody>
        <tr id="data">

        </tr>
      </tbody>
    </table>
  </div>

  
</div>


  <script>
    $('.errorMessageDiv').hide()
    $(document).ready(() => {
      $("td").attr('style', 'color:black;')
      $(`input[type="date"]`).change(() => {
        $('#data').empty()
        let date = $(`input[type="date"]`).val()
        $.ajax({
          url: "/findSchedule",
          method: 'POST',
          data: {
            SI: date
          },
          success: (data) => {
            if (data == 'Back dated schedule can not be booked!') {
              $('.successMsgDiv').hide()
              $('.errorMessageDiv').show()
              $('#errorMessage').text(data)
            } else {
            $('.errorMessageDiv').hide()
            $('.successMsgDiv').hide()
            $('#data').empty()
            let sData = Object.values(data[0])
            $('#Date').text(data[1])
            $('#weekDay').text(data[2])
            let timeSchedule = 0
            for (let i = 3; i < sData.length; i++) {
              timeSchedule++
              const e = sData[i];
              if (e == null || e == '') {
                $('#data').append(`<td class="bg-success" onclick="getData(this)" data-id="${timeSchedule}" data-day="${data[3]}" data-month="${data[4]}">Available</td>`)
              } else {
                $('#data').append(`<td class="bg-danger" onclick="getData(this)" data-id="${timeSchedule}" data-day="${data[3]}" data-month="${data[4]}">${e}</td>`)
              }
            }
            }
           
          }
        })
      })

    })

function getData(e) {
        
        let day = e.getAttribute("data-day");
        let month = e.getAttribute("data-month");
        let timeSchedule = e.getAttribute("data-id");
       
       let form = `
       <div class="container-fluid text-center pt-4">
      <hr><hr>
      <div class="container-fluid text-center p-0 logoDiv">
          <h1 style="font-family: Cooper Black, Fantasy, sans-serif; font-size: 28px;" class="mt-2 _head text-dark">Sports<strong><i style="font-size:30px" class="fa">&#xf1e3;</i></strong>Fantasy</h1>
      </div>
      <hr><hr>
      <div class="container-fluid d-flex justify-content-center text-center mt-3 mb-3 pb-2">
        <a class="" href="/user"><button class="btn btn-outline-dark" style="border-radius: 20px;">Home</button></a>
        <a class="" href="/features"><button class="btn btn-outline-dark" style="border-radius: 20px;">Features</button></a>
        <a class="" href="/contact"><button class="btn btn-outline-dark" style="border-radius: 20px;">Contact</button></a>
      </div>
    </div>
       <div class="container text-center" style="width: 300px;">
        <form action="/adminBookSchedule" method="post">
            <div class="container mt-2">
                <div class="row mt-2">
                   
                    <div class="col">
                      <input id="name" type="text" class="form-control" name="name" placeholder="Name"/>
                    </div>
                  </div>
                  <div class="row mt-2">
                  
                    <div class="col">
                      <input id="mobile" type="text" class="form-control" name="mobile" placeholder="Mobile"/>
                    </div>
                  </div>
                  <div class="container d-flex justify-content-end mt-4 mr-3">
                    <input type="hidden" name="day" value="${day}"/>
                    <input type="hidden" name="month" value="${month}"/>
                    <input type="hidden" name="timeSchedule" value="${timeSchedule}"/>
                    <input class="btn btn-outline-dark mr-2" name="submit" type="submit" value="Book" />
                    <input class="btn btn-outline-dark mr-2" formaction="/cancelBooking" name="submit" type="submit" value="Cancel Booking" />
                  </div>
            </form>
          </div>`
     

      var originalContents = document.body.innerHTML;

      document.body.innerHTML = form;

      // window.print();

      // document.body.innerHTML = originalContents;

      }

      
  </script>
</body>